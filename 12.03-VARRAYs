1Ô∏è‚É£ What is VARRAY?

VARRAY (Variable-size Array) is a collection datatype in PL/SQL used to store multiple values of the same datatype in a fixed-size, ordered list.

üëâ Elements are stored sequentially and accessed using index numbers.

2Ô∏è‚É£ Why VARRAY?

VARRAY is used when:

Maximum number of elements is known in advance
Data must be stored and fetched as a single unit
Order of elements must be preserved

Example:
‚úî Phone numbers (max 3)
‚úî Employee skills (max 5)
‚úî Monthly ratings (max 12)

3Ô∏è‚É£ Key Characteristics

Fixed maximum size
Index starts from 1
Stored inside database tables
Always dense (no gaps allowed)
Maintains order of insertion

4Ô∏è‚É£ Syntax

Type Declaration

        TYPE type_name IS VARRAY(max_size) OF datatype;

Variable Declaration

        var_name type_name;

5Ô∏è‚É£ Simple Example (Beginner)

DECLARE
  TYPE num_varray IS VARRAY(5) OF NUMBER;
  v_nums num_varray := num_varray(10, 20, 30);
BEGIN
  DBMS_OUTPUT.PUT_LINE(v_nums(1));
END;
/


6Ô∏è‚É£ Common VARRAY Methods

| Method | Purpose             |
| ------ | ------------------- |
| COUNT  | Number of elements  |
| FIRST  | First index         |
| LAST   | Last index          |
| EXTEND | Add element         |
| TRIM   | Remove last element |
| LIMIT  | Maximum size        |


7Ô∏è‚É£ Example Using Methods
DECLARE
  TYPE name_varray IS VARRAY(3) OF VARCHAR2(20);
  v_names name_varray := name_varray('Ram');
BEGIN
  v_names.EXTEND;
  v_names(2) := 'Sam';

  DBMS_OUTPUT.PUT_LINE('Total: ' || v_names.COUNT);
  DBMS_OUTPUT.PUT_LINE('Limit: ' || v_names.LIMIT);
END;
/


8Ô∏è‚É£ Limitation of VARRAY

‚ùå Cannot exceed the maximum size.

v_names.EXTEND; -- Error if LIMIT reached

Error:
ORA-06532: Subscript outside of limit


9Ô∏è‚É£ Looping Through VARRAY

FOR i IN 1 .. v_nums.COUNT LOOP
  DBMS_OUTPUT.PUT_LINE(v_nums(i));
END LOOP;


üîü VARRAY at Database Level
Create Type
CREATE TYPE phone_varray IS VARRAY(3) OF VARCHAR2(15);
/

Create Table
CREATE TABLE customers (
  cust_id NUMBER,
  phones  phone_varray
);

Insert Data
INSERT INTO customers VALUES (
  1,
  phone_varray('9876543210', '9123456789')
);

1Ô∏è‚É£1Ô∏è‚É£ Read VARRAY Data
SELECT c.cust_id, p.COLUMN_VALUE AS phone
FROM customers c,
     TABLE(c.phones) p;


-------------------------------------------------------------------------

1Ô∏è‚É£ COUNT ‚Äì Number of Elements
üîπ What?

Returns the current number of elements in the VARRAY.

üîπ Why?

To know how many values are present (used in loops).

üîπ Example
DECLARE
  TYPE num_varray IS VARRAY(5) OF NUMBER;
  v_nums num_varray := num_varray(10, 20, 30);
BEGIN
  DBMS_OUTPUT.PUT_LINE(v_nums.COUNT);
END;
/

üîπ Output
3

---------------------------------------------------------------------------------------
2Ô∏è‚É£ FIRST ‚Äì First Index
üîπ What?

Returns the first index in the VARRAY.

üîπ Why?

To know where the collection starts.

üîπ Example

DECLARE
  TYPE num_varray IS VARRAY(5) OF NUMBER;
  v_nums num_varray := num_varray(10, 20, 30);
BEGIN
  DBMS_OUTPUT.PUT_LINE(v_nums.COUNT);
END;
/

üîπ Output
1
---------------------------------------------------------------------------------------

3Ô∏è‚É£ LAST ‚Äì Last Index
üîπ What?

Returns the last index position of the VARRAY.

üîπ Why?

To find the last element index.

üîπ Example

DECLARE
  TYPE num_varray IS VARRAY(5) OF NUMBER;
  v_nums num_varray := num_varray(10, 20, 30);
BEGIN
  DBMS_OUTPUT.PUT_LINE(v_nums.COUNT);
END;
/

üîπ Output
3

--------------------------------------------------------
4Ô∏è‚É£ EXTEND ‚Äì Add Element
üîπ What?

Adds a new empty element at the end of the VARRAY.

üîπ Why?

To insert values dynamically.

üîπ Example
DECLARE
  TYPE num_varray IS VARRAY(5) OF NUMBER;
  v_nums num_varray := num_varray(10, 20);
BEGIN
  v_nums.EXTEND;     -- adds position 3
  v_nums(3) := 30;

  DBMS_OUTPUT.PUT_LINE(v_nums.COUNT);
END;
/

üîπ Output
3

-------
notes 
i have declare the array to store the 5 element 
initially i have stored a 2 element i need to store the 3 element so i need to use the extent key word 
along with the extent key word we can you size but if you try to extend more the size of declaration it throw the error 
initially i declared 5 later i used 2 to the values after that i have planed to extent -4 now the total array size become 6 
already we that varray is fixed size so it throw the error .

--------------
DECLARE
  TYPE num_varray IS VARRAY(5) OF NUMBER;
  v_nums num_varray := num_varray(10, 20);
BEGIN
  v_nums.EXTEND(4);     -- adds position 3
  v_nums(5) := 30;
  DBMS_OUTPUT.PUT_LINE(v_nums.COUNT);
END;
/

‚ùå If EXTEND exceeds LIMIT ‚Üí ERROR.


--------------------------------------------------------

5Ô∏è‚É£ TRIM ‚Äì Remove Last Element
üîπ What?

Removes the last element from the VARRAY.

üîπ Why?

To delete recently added data.

üîπ Example
DECLARE
  TYPE num_varray IS VARRAY(5) OF NUMBER;
  v_nums num_varray := num_varray(10, 20, 30);
BEGIN
  v_nums.TRIM;

  DBMS_OUTPUT.PUT_LINE(v_nums.COUNT);
END;
/

--------------------------------------------------------

6Ô∏è‚É£ LIMIT ‚Äì Maximum Size
üîπ What?

Returns the maximum number of elements allowed.

üîπ Why?

To prevent runtime errors before EXTEND.

üîπ Example
BEGIN
  DBMS_OUTPUT.PUT_LINE(v_nums.LIMIT);
END;
/

üîπ Output
5

üîπ Output
2


